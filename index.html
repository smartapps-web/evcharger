<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EV Charge Calc - Rahmat Saleh</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --danger: #ef4444;
            --success: #10b981;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .app-container {
            width: 100%;
            max-width: 450px;
        }

        header {
            text-align: center;
            margin-bottom: 25px;
        }

        .card {
            background: var(--card-bg);
            padding: 24px;
            border-radius: 24px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .input-group { margin-bottom: 18px; }
        .input-group label {
            display: block;
            font-size: 0.7rem;
            font-weight: 700;
            color: var(--text-muted);
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        input {
            width: 100%;
            padding: 14px;
            border: 1.5px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            box-sizing: border-box;
            background: #f8fafc;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        button.btn-main {
            width: 100%;
            padding: 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 14px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.4);
        }

        /* STAMP / CREDITS STYLING (DIKECILKAN & DISAMARKAN) */
        .stamp-container {
            margin-top: 30px;
            padding-top: 15px;
            border-top: 1px solid #f1f5f9;
            text-align: center;
            opacity: 0.6; /* Membuat tampilan lebih samar */
        }

        .made-by {
            font-size: 0.6rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            margin-bottom: 2px;
            display: block;
        }

        .author-name {
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 10px;
            display: block;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 12px;
        }

        .social-links a {
            text-decoration: none;
            color: var(--text-muted);
            font-size: 1rem;
            transition: color 0.2s;
        }

        .social-links a:hover { color: var(--primary); }

        /* MODAL STYLES */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(5px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal-content {
            background: white;
            width: 100%;
            max-width: 420px;
            padding: 25px;
            border-radius: 28px;
            animation: modalSlide 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes modalSlide { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .res-header { text-align: center; margin-bottom: 20px; }
        .res-value { font-size: 2.2rem; font-weight: 800; color: var(--success); margin: 5px 0; }
        .detail-section { border-top: 1px solid #f1f5f9; padding-top: 15px; }
        .detail-row { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 0.9rem; }
        .summary-box { background: #f0fdf4; color: #166534; padding: 15px; border-radius: 16px; font-size: 0.88rem; line-height: 1.6; margin-top: 15px; border-left: 4px solid var(--success); }
        .btn-close { width: 100%; padding: 12px; background: #f1f5f9; color: #475569; border: none; border-radius: 12px; margin-top: 20px; font-weight: 600; cursor: pointer; }
    </style>
</head>
<body>

    <div class="app-container">
        <header>
            <h1 style="font-size: 1.6rem; margin:0; letter-spacing: -1px;">⚡ EV Calculator</h1>
            <p style="color: var(--text-muted); font-size: 0.9rem; margin-top: 5px;">Estimasi biaya & waktu pengisian daya</p>
        </header>

        <div class="card">
            <div class="input-group">
                <label>Kapasitas Baterai (kWh)</label>
                <input type="number" id="capacity" step="0.1" oninput="saveData()">
            </div>

            <div class="grid-2">
                <div class="input-group">
                    <label>SoC Awal (%)</label>
                    <input type="number" id="startLevel" oninput="saveData()">
                </div>
                <div class="input-group">
                    <label>SoC Target (%)</label>
                    <input type="number" id="targetLevel" oninput="saveData()">
                </div>
            </div>

            <div class="grid-2">
                <div class="input-group">
                    <label>Daya Cas (kW)</label>
                    <input type="number" id="power" step="0.1" oninput="saveData()">
                </div>
                <div class="input-group">
                    <label>Tarif (Rp/kWh)</label>
                    <input type="number" id="tariff" oninput="saveData()">
                </div>
            </div>

            <div class="input-group">
                <label>Energy Loss (%)</label>
                <input type="number" id="energyLoss" oninput="saveData()">
            </div>

            <button class="btn-main" onclick="calculate()">Hitung Estimasi</button>

            <div class="stamp-container">
                <span class="made-by">Developed By</span>
                <span class="author-name">Rahmat Saleh</span>
                <div class="social-links">
                    <a href="https://instagram.com/rach.mad40" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                    <a href="https://facebook.com/rahmat saleh" target="_blank"><i class="fa-brands fa-facebook"></i></a>
                    <a href="https://tiktok.com/@rahmat.saleh475" target="_blank"><i class="fa-brands fa-tiktok"></i></a>
                    <a href="https://youtube.com/@pesonadronenusantara" target="_blank" title="YouTube"><i class="fa-brands fa-youtube"></i></a>
                </div>
            </div>
        </div>
    </div>

    <div id="resultModal" class="modal-overlay">
        <div class="modal-content">
            <div class="res-header">
                <span style="font-size: 0.85rem; color: var(--text-muted); font-weight: 600; text-transform: uppercase;">Estimasi Biaya</span>
                <div id="costRes" class="res-value">--</div>
                <div id="timeResTop" style="color: var(--primary); font-weight: 700; font-size: 1.1rem;">⏱️ --</div>
            </div>

            <div class="detail-section">
                <div class="detail-row"><span class="detail-label">Energi Terisi (Netto)</span><span id="netRes" class="detail-val">--</span></div>
                <div class="detail-row"><span class="detail-label" id="lossLabel">Energy Loss</span><span id="lossRes" class="detail-val" style="color: var(--danger);">--</span></div>
                <div class="detail-row"><span class="detail-label">Total Energi dari PLN</span><span id="plnRes" class="detail-val">--</span></div>
            </div>

            <div id="summaryText" class="summary-box"></div>
            <button class="btn-close" onclick="closeModal()">Tutup</button>
        </div>
    </div>

    <script>
        function saveData() {
            const inputs = ['capacity', 'startLevel', 'targetLevel', 'power', 'tariff', 'energyLoss'];
            inputs.forEach(id => localStorage.setItem('ev_' + id, document.getElementById(id).value));
        }

        function loadData() {
            const defaults = { 'capacity': '26.7', 'startLevel': '30', 'targetLevel': '100', 'power': '6.6', 'tariff': '1699', 'energyLoss': '10' };
            Object.keys(defaults).forEach(id => {
                const saved = localStorage.getItem('ev_' + id);
                document.getElementById(id).value = (saved !== null) ? saved : defaults[id];
            });
        }

        function calculate() {
            const cap = parseFloat(document.getElementById('capacity').value);
            const start = parseFloat(document.getElementById('startLevel').value);
            const target = parseFloat(document.getElementById('targetLevel').value);
            const pwr = parseFloat(document.getElementById('power').value);
            const lossPercent = parseFloat(document.getElementById('energyLoss').value);
            const price = parseFloat(document.getElementById('tariff').value);

            if (target <= start) return alert("Target SoC harus lebih tinggi!");

            const energyNeeded = cap * ((target - start) / 100);
            const lossKwh = energyNeeded * (lossPercent / 100);
            const totalEnergyPLN = energyNeeded + lossKwh;
            const totalCost = totalEnergyPLN * price;
            const hours = energyNeeded / pwr;
            const h = Math.floor(hours);
            const m = Math.round((hours - h) * 60);
            const timeStr = `${h} jam ${m} menit`;

            document.getElementById('costRes').textContent = 'Rp ' + Math.round(totalCost).toLocaleString('id-ID');
            document.getElementById('timeResTop').textContent = `⏱️ ${timeStr}`;
            document.getElementById('netRes').textContent = `${energyNeeded.toFixed(2)} kWh`;
            document.getElementById('lossRes').textContent = `+${lossKwh.toFixed(2)} kWh`;
            document.getElementById('plnRes').textContent = `${totalEnergyPLN.toFixed(2)} kWh`;
            document.getElementById('lossLabel').textContent = `Energy Loss (${lossPercent}%)`;
            
            document.getElementById('summaryText').innerHTML = `Mengisi daya dari <b>${start}%</b> ke <b>${target}%</b> memerlukan <b>${energyNeeded.toFixed(2)} kWh</b>. Dengan <i>loss</i> ${lossPercent}%, PLN menarik <b>${totalEnergyPLN.toFixed(2)} kWh</b>. Waktu estimasi: <b>${timeStr}</b> dengan biaya <b>Rp ${Math.round(totalCost).toLocaleString('id-ID')}</b>.`;

            document.getElementById('resultModal').style.display = 'flex';
        }

        function closeModal() { document.getElementById('resultModal').style.display = 'none'; }
        window.onload = loadData;
        window.onclick = (e) => { if (e.target == document.getElementById('resultModal')) closeModal(); }
    </script>
</body>
</html>